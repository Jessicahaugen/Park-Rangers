<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>View All Trips</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link rel="stylesheet" href="views/loginStyles.css">
    <link rel="stylesheet" href="./views/itinerary.css" />

  </head>
  <body>
    <nav class="navbar">
      <div class="container-fluid">
        <a class="navbar-brand" href="/">
          <img src="assets/logo.png" alt="" width="180px" height="80px"  class="d-inline-block align-text-top" href="/">
        </a>
        <ul class="nav justify-content-end">
            <li class="nav-item">
              <a class="nav-link" href="/explore">Explore</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/view-all-trips">View Trips</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/login">Login</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/register">Register</a>
            </li>
        </ul>
  </nav>
    <div class="main-container">
      ${Object.entries(objectOfTrips).map(([tripName,trips]) => `
      <div class="trip-container">
        <h3>${tripName}</h3>
        <h4>Start Date: ${trips[0].startDate}</h4>
        <h4>End Date: ${trips[0].endDate}</h4>
        ${trips.map(trip =>`
          <div class="small-trip-card">
          <h3>Park Name: ${trip.Parks.parkName}</h3>
          <form action="/delete-park/${trip.Parks.id}" method="POST">
            <input type="hidden" name="parkId" value="${trip.Parks.id}" />
            <button type="submit">Delete From Trip</button>
          </form>
        </div>
          `).join("")} <br />
        <form action="/delete-trip/${tripName}" method="POST">
          <button type="submit">Delete Trip</button>
        </form>
        <form action="/edit-trip/${tripName}" method="POST" class="editForm">
          <input
            style="display: none"
            type="hidden"
            name="tripName"
            value="${tripName}"
          />
          <button type="button" onclick="displayInput(this)">Edit Trip</button>
          <input
            type="text"
            class="new-name"
            name="newTripName"
            value="${tripName}"
            style="display: none"
          />
          <input
            type="date"
            class="new-start-date"
            name="newStartDate"
            value="${trips[0].startDate}"
            style="display: none"
          />
          <input
            type="date"
            class="new-end-date"
            name="newEndDate"
            value="${trips[0].endDate}"
            style="display: none"
          />
          <button type="submit" class="edit-trip-button" style="display: none">
            Submit Changes
          </button>
        </form>
        `).join("")}
      </div>
    </div>
  </body>
  <script>
    const displayInput = (target) => {
      const editForm = target.parentNode;
      const editButton = editForm.querySelector(".edit-trip-button");
      const inputField = editForm.querySelector(".new-name");
      const newStart = editForm.querySelector(".new-start-date");
      const newEnd = editForm.querySelector(".new-end-date");

      if (inputField.style.display === "none") {
        inputField.style.display = "block";
        editButton.style.display = "block";
        newStart.style.display = "block";
        newEnd.style.display = "block";

      } else {
        inputField.style.display = "none";
        editButton.style.display = "none";
        newStart.style.display = "none";
        newEnd.style.display = "none";
      }
    };
  </script>
</html>
